(function(a){var c=function(){};c.prototype=a.extend(c.prototype,{name:"ZFchainedAjax",options:{url:"",txtChoose:"Choose",txtLoading:"Loading...",hide_empty:0,show_number_items:0,el_type:"",lay_name:"",searchAnySelection:!1},initialize:function(e,d){this.options=a.extend({},this.options,d);var b=this;a(".form-element-subrow",e).each(function(){b.fetchSelect(a(this),e)});a(".form-element-subrow",e).last().find("select").trigger("change");e.closest(".zoo-filter").find("button.zfac-clear").on("click",
function(b){b.preventDefault();a(".form-element-subrow",e).eq(0).find("select").val("");a(".form-element-subrow",e).slice(1).remove();a("input",e).val("")})},fetchSelect:function(e,d){var b=this;a("select",e).on("change",function(){var c=a(this);e.nextAll(".form-element-subrow").remove();a("input",d).val("");if(c.val()){b.options.searchAnySelection&&b.saveValues(d);var k=a("option:selected",c).text();a("option:selected",c).text(b.options.txtLoading);a('button[type="submit"]',c.closest(".zoo-filter")).attr("disabled",
"disabled");a.getJSON(b.options.url+"&task=getCats",{root:c.val(),hide_empty:b.options.hide_empty,show_number_items:b.options.show_number_items,el_type:b.options.el_type,lay_name:b.options.lay_name},function(h){var f="";a.each(h,function(a,b){f+='<option value="'+b.id+'">'+b.name+"</option>"});f?(f='<option value="">'+b.options.txtChoose+"</option>"+f,h=a('<div class="form-element-subrow"><select>'+f+"</select></div>").insertAfter(e),b.fetchSelect(h,d)):b.options.searchAnySelection||b.saveValues(d);
a("option:selected",c).text(k);a('button[type="submit"]',c.closest(".zoo-filter")).removeAttr("disabled")})}})},saveValues:function(c){var d="";a("select",c).each(function(b){d+=(0!=b?",":"")+a(this).val()});a("input",c).val(d)}});a.fn[c.prototype.name]=function(){var e=arguments,d=e[0]?e[0]:null;return this.each(function(){var b=a(this);if(c.prototype[d]&&b.data(c.prototype.name)&&"initialize"!=d)b.data(c.prototype.name)[d].apply(b.data(c.prototype.name),Array.prototype.slice.call(e,1));else if(!d||
a.isPlainObject(d)){var g=new c;c.prototype.initialize&&g.initialize.apply(g,a.merge([b],e));b.data(c.prototype.name,g)}else a.error("Method "+d+" does not exist on jQuery."+c.name)})}})(jQuery);