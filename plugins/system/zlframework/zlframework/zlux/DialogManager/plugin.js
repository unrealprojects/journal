/* ===================================================
 * ZL Framework
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
!function(a,b){"use strict";var c=function(b){this.options=a.extend({},this.options,b),this.events={}};a.extend(c.prototype,a.zlux.Main.prototype,{name:"dialog",options:{width:"300",height:"150",title:"Dialog",scrollbar:!0},initDialog:function(){var c=this;c.options.dialogClass="zlux-dialog "+c.options.dialogClass,c.main=a("<div />").appendTo(a("body")).dialog(a.extend({autoOpen:1,resizable:!1,height:"auto"},c.options)),c.main.hide(),c.content=a('<div class="zlux-dialog-content" />').appendTo(c.main),c.widget=c.main.dialog("widget"),c.main.on("dialogopen",function(){c.widget.data("dialog-dragged")||c.widget.position(a.extend({my:"center",at:"center",of:b},c.options.position))}),c.main.on("dialogdragstart",function(){c.widget.data("dialog-dragged",1)}),c._spinner=a('<i class="zlux-loader-circle-big icon-spinner icon-spin" />').appendTo(c.widget),c._spinner_area=c.main;var d=a.Deferred().resolve();c.options.scrollbar&&(d=a.zlux.assets.load(a.zlux.url.zlfw("assets/js/jquery.plugins/nanoscroller/nanoscroller.min.js"),function(){c.main.addClass("zlux-scroller").nanoScroller({preventPageScrolling:!0,contentClass:"zlux-dialog-content"})})),a(".ui-dialog-titlebar-close",c.widget).html('<i class="icon-remove" />'),d.done(function(){c.inited=!0,c.trigger("InitComplete")})},initContent:function(){var a=this;a.main.show(),a.widget.attr("data-zlux-status","ready"),a.options.scrollbar&&a.scrollbar("refresh"),a.contentinited=!0,a.spinner("hide")},toggle:function(){var a=this;a.inited?a.dialog(a.dialog("isOpen")?"close":"open"):a.initDialog()},dialog:function(a){return this.main.dialog(a)},scrollbar:function(b){var c=this;if("refresh"===b){var d=a(".pane .slider",c.main);c.scrollbar("show"),c.main.nanoScroller();var e=Math.round(c.main.height())-Math.round(d.height());e>=0&&5>=e&&c.scrollbar("hide")}else c.main.nanoScroller("hide"===b?{stop:!0}:"show"===b?{stop:!1}:b)},spinner:function(a){var b=this;if(b.contentinited)if("show"===a)b.main.fadeTo(0,.5),b._spinner.show(),b.options.scrollbar&&b.scrollbar("hide"),b.spinning=!0;else{b.options.scrollbar&&b.scrollbar("show"),b._spinner.hide();var c=b.main;b.toolbar&&(c=c.add(b.toolbar.wrapper)),c.fadeTo("slow",1),b.spinning=!1}},newToolbar:function(b,c,d){var e=this;e.toolbar||(e.toolbar={},e.toolbar.wrapper=a('<div class="zlux-dialog-toolbar" />').hide().insertAfter(e.widget.children()[0]));var f=a('<div class="zlux-dialog-toolbar-'+c+'"><ul class="inline" /></div>').appendTo(e.toolbar.wrapper);a.each(b,function(b,c){a("ul",f).append(a("<li />").append(a('<i data-id="'+c.id+'" class="icon-'+c.icon+' icon-2x icon-border" title="'+c.title+'">'+(c.subicon?'<i class="icon-'+c.subicon+'"></i>':"")+"</i>").on("click",function(){return a(this).hasClass("disabled")?!1:void c.click(a(this))})))}),a(".zlux-dialog-toolbar-backtomain",e.toolbar.wrapper).on("click",function(){d()})},newSubToolbar:function(b,c){var d=this;a('<div class="zlux-dialog-subtoolbar-'+b+'" />').hide().appendTo(a(".zlux-dialog-toolbar-"+c,d.toolbar.wrapper))},setMainToolbar:function(b){var c=this;c.newToolbar(b,"main"),c.toolbar.wrapper.prepend(a('<i class="zlux-dialog-toolbar-backtomain icon-reply icon-border" title="Back to Main view" />').on("click",function(){a('[class^="zlux-dialog-toolbar-"]',c.toolbar.wrapper).hide(),a(".zlux-dialog-toolbar-main",c.toolbar.wrapper).show()}))},showToolbar:function(b){var c=this;a(".zlux-dialog-toolbar-"+b,c.toolbar.wrapper).show(),a(".zlux-dialog-toolbar-main",c.toolbar.wrapper).hide(),a(".zlux-dialog-toolbar-backtomain",c.toolbar.wrapper).show()},toggleSubtoolbar:function(b,c){var d=this;c=a(".zlux-dialog-toolbar-"+c,d.toolbar.wrapper);var e=a(".zlux-dialog-subtoolbar-"+b,c);e.siblings("div").slideUp("fast",function(){e.slideToggle("fast")})},toolbarBtnState:function(b,c,d){var e=this,f=a(".zlux-dialog-toolbar-"+b+' i[data-id="'+c+'"]',e.toolbar.wrapper);"disabled"===d?f.animate({color:"#C0C0C0"},200,function(){f.addClass("disabled")}):f.animate({color:"#444"},200,function(){f.removeClass("disabled")})}}),a.zlux[c.prototype.name]=function(){var a=arguments;return new c(a[0]?a[0]:{})}}(jQuery,window,document);